# CBrain Speed Game Agent

2026 계산뇌과학회 겨울학교 팀 과제 - 제스처 기반 스피드 게임 에이전트

## 개요

시계판 기반 인코딩 방식을 사용하여 손 제스처를 한글로 변환하는 실시간 에이전트입니다.

```
[웹캠] → [손 검출] → [시계판 매핑] → [상태 머신] → [한글 조합] → [단어 추천]
                                         ↓
                                    [오디오 신호]
```

## Phase 2 완성 기능

- ✅ 실시간 손 검출 (MediaPipe / 색상 기반)
- ✅ 시계판 12등분 영역 매핑
- ✅ 상태 머신 기반 순차 입력 (카테고리 → 글자수 → 자음 → 모음)
- ✅ 손 위치 안정성 검증 (70% 임계값)
- ✅ 오디오 신호 (준비/실행 구분 비프음)
- ✅ 한글 렌더링 (PIL 기반)
- ✅ 단어 추천 엔진 (정확 매칭 + 유사도 매칭)
- ✅ 패스 기능
- ✅ 향상된 UI (진행바, 안정성 표시, 상태 안내)

## 인코딩 방식

### 시계판 영역 매핑
화면을 시계처럼 12등분하여 각 영역에 의미를 부여합니다.

```
           12(ㅇ/ㅡ)
      11(ㅌ/ㅐ)    1(ㄱ/ㅏ)
    10(ㅋ/ㅔ)        2(ㄴ/ㅑ)
   9(ㅊ/ㅣ)          3(ㄷ/ㅓ)
    8(ㅈ/ㅠ)        4(ㄹ/ㅕ)
      7(ㅅ/ㅜ)    5(ㅁ/ㅗ)
           6(ㅂ/ㅛ)
```

### 입력 순서
1. **카테고리** (1~5시 방향): 감정/행동/동물/스포츠/자연
2. **글자수** (1~5시 방향): 1~5글자
3. **자음+모음** 반복: 글자수만큼 반복

### 시간 구조
- **준비 시간 (1.5초)**: 손 이동, 주황색 표시
- **실행 시간 (1.0초)**: 손 고정, 초록색 표시, 안정성 70% 이상 필요

## 설치

```bash
# 기본 의존성
pip install opencv-python numpy mediapipe Pillow

# 오디오 (선택적)
pip install pyaudio

# 또는 한번에
pip install -r requirements.txt
```

## 실행

### Phase 2 버전 (권장)
```bash
# 웹캠 모드
python main_v2.py --device 0

# 시뮬레이션 모드 (마우스로 테스트)
python main_v2.py --simulation

# 오디오 없이
python main_v2.py --no-audio

# 시간 조절
python main_v2.py --prep-time 2.0 --exec-time 1.5
```

### 기존 버전
```bash
python main.py --simulation
```

## 조작법

| 키 | 기능 |
|---|------|
| SPACE | 게임 시작/재시작 |
| P | 패스 (현재 단어 건너뛰기) |
| R | 리셋 |
| Q | 종료 |

## 파일 구조

```
gesture_agent/
├── main_v2.py           # Phase 2 메인 (권장)
├── main.py              # Phase 1 메인
├── gesture_agent.py     # 핵심 로직 모듈
├── audio_signal.py      # 오디오 신호 모듈
├── korean_renderer.py   # 한글 렌더링 모듈
├── webcam_capture.py    # 웹캠 캡처 유틸리티
├── requirements.txt     # 의존성
├── CODE_REVIEW.md       # 코드 검토 문서
└── README.md            # 이 문서
```

## 단어 리스트 (50개)

| 카테고리 | 단어 |
|---------|------|
| 감정 및 상태 | 기쁨, 슬픔, 화남, 졸음, 배고픔, 덥다, 춥다, 사랑, 놀람, 창피 |
| 행동 및 동사 | 수영, 달리기, 요리, 운전, 자전거, 낚시, 사진찍기, 전화하기, 청소, 공부 |
| 동물 | 토끼, 코끼리, 나비, 고양이, 고릴라, 펭귄, 기린, 악어, 뱀, 새 |
| 스포츠 | 농구, 야구, 탁구, 양궁, 역도, 태권도, 볼링, 골프, 스쿼시, 스키 |
| 날씨 및 자연 | 해, 비, 눈, 번개, 바람, 구름, 달, 별, 꽃, 나무 |

## 뇌 기전 활용 (가산점)

1. **계층적 시각 처리**: 저수준(엣지) → 고수준(손 형태) 순차 처리
2. **선택적 주의**: 손 영역에 대한 집중 처리
3. **예측 코딩**: 이전 상태 기반 다음 입력 예측
4. **시간적 통합**: 다중 프레임 정보 통합 (안정성 검증)

## 트러블슈팅

### 한글이 깨져서 나와요
- Pillow가 설치되어 있는지 확인: `pip install Pillow`
- 시스템에 한글 폰트가 있는지 확인

### 오디오가 안 나와요
- PyAudio 설치: `pip install pyaudio`
- Mac: `brew install portaudio` 먼저 실행
- 오디오 없이 실행: `--no-audio` 옵션 사용

### 손 인식이 안 돼요
- MediaPipe 설치: `pip install mediapipe`
- 조명이 충분한지 확인
- 카메라가 제대로 연결되었는지 확인

## TODO (Phase 3)

- [ ] 종성 입력 지원
- [ ] 녹화/재생 기능
- [ ] 성능 통계 및 분석
- [ ] 멀티 플레이어 모드
